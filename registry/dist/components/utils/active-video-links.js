!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["utils/active-video-links"]=t():e["utils/active-video-links"]=t()}(globalThis,(()=>(()=>{var e,t,o={642:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=642,e.exports=t},401:e=>{"use strict";e.exports="这个组件会将视频简介中的普通网址转换为可点击的链接，并将<del>被 Bilibili 抛弃</del>已失效的 `acg.tv` 跳转链接修复为 `nicovideo.jp` 链接。\n\n例如: `https://acg.tv/sm37507315` → `https://www.nicovideo.jp/watch/sm37507315`\n\n<i>本组件不会保证目标链接的安全性，因此在点击前请自行验证其是否可信</i>\n"}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={exports:{}};return o[e](i,i.exports,r),i.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(o,n){if(1&n&&(o=this(o)),8&n)return o;if("object"==typeof o&&o){if(4&n&&o.__esModule)return o;if(16&n&&"function"==typeof o.then)return o}var i=Object.create(null);r.r(i);var c={};e=e||[null,t({}),t([]),t(t)];for(var s=2&n&&o;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>c[e]=()=>o[e]));return c.default=()=>o,r.d(i,c),i},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{"use strict";r.d(i,{component:()=>u});const e=coreApis.componentApis.define,t=coreApis.utils.log,o=coreApis.utils.urls,n=(0,t.useScopedConsole)("activeVideoLinks");let c=null;const s=/(?<!(\>|'|"|\/))(http:\/\/|https:\/\/|www\.)[^(\s,;())]+/g,l=(e,t)=>{const o=e.substring(0,t),n=o.lastIndexOf("<a ");if(-1===n)return!1;return n>o.lastIndexOf("</a>")},a=()=>{try{document.querySelectorAll('a[href*="acg.tv"][href*="sm"]').forEach((e=>{const t=e.getAttribute("href");if(t){const o=t.replace("acg.tv","nicovideo.jp/watch");e.setAttribute("href",o),n.log(`Niconico Fix: ${t} → ${o}`)}})),(()=>{const e=document.querySelector(".desc-info-text");if(!e)return;const t=e.innerHTML;let o=t;const n=[...t.matchAll(s)];for(let e=n.length-1;e>=0;e--){const r=n[e],i=r[0],c=r.index??0;if(l(t,c))continue;const s=`<a href='${i.replace(/^https?:\/\//,"//").replace(/^www\./,"//")}' target='_blank'>${i}</a>`;o=o.substring(0,c)+s+o.substring(c+i.length)}o!==t&&(e.innerHTML=o)})()}catch(e){n.error("处理链接时遇到 Error:",e)}},d=()=>{n.log("视频链接增强已启用"),a(),c&&c.disconnect(),c=new MutationObserver(a),c.observe(document.documentElement,{childList:!0,subtree:!0}),n.log("已设置 Observer")},u=(0,e.defineComponentMetadata)({name:"activeVideoLinks",displayName:"视频链接增强",tags:[componentsTags.utils],entry:d,reload:d,unload:()=>{c&&(c.disconnect(),c=null)},urlInclude:o.videoUrls,author:{name:"Alan Ye",link:"https://github.com/at-wr"},commitHash:"c0593c49391cd5d0fd514e6632b37ad6cf7f3875",coreVersion:"2.10.1",description:(()=>{const e=r(642);return{...Object.fromEntries(e.keys().map((t=>[t.match(/index\.(.+)\.md$/)[1],e(t)]))),"zh-CN":()=>Promise.resolve().then(r.t.bind(r,401,17)).then((e=>e.default))}})()})})(),i=i.component})()));